# ğŸš— DIGIY PRO DRIVER

**L'application chauffeur DIGIYLYFE â€” 0% commission**

> *"L'argent au peuple â€” Le chauffeur garde ce qu'il gagne"*

---

## ğŸ¯ C'EST QUOI ?

**DIGIY PRO DRIVER** est l'espace professionnel des chauffeurs de l'Ã©cosystÃ¨me DIGIYLYFE.

### Philosophie : 0% Commission
- âŒ **Pas comme Uber** (25% de vol)
- âŒ **Pas comme Bolt** (20% de vol)
- âœ… **Abonnement fixe** transparent
- âœ… **Le chauffeur garde 100% de ses gains**

---

## ğŸ“‚ STRUCTURE DU PROJET

```
digiy-pro-driver/
â”œâ”€â”€ authentification-chauffeur.html    # Connexion PIN
â”œâ”€â”€ index.html                          # Dashboard principal
â”œâ”€â”€ profil-chauffeur.html              # Fiche professionnelle
â”œâ”€â”€ courses.html                        # Gestion des courses (pool + mines)
â”œâ”€â”€ gains.html                          # Statistiques & revenus
â”œâ”€â”€ historique.html                     # Historique des courses
â”œâ”€â”€ vehicule.html                       # Infos vÃ©hicule
â””â”€â”€ README.md                           # Ce fichier
```

---

## ğŸ” SYSTÃˆME D'AUTHENTIFICATION

### PIN Simple (Terrain)
- **TÃ©lÃ©phone** : +221XXXXXXXXX
- **PIN** : 4 chiffres
- **Pas de mot de passe compliquÃ©**
- **Pas de KYC lourd**
- **Connexion rapide terrain**

### SÃ©curitÃ©
```javascript
// RPC Supabase sÃ©curisÃ©
verify_access_pin(p_phone, p_pin, p_module: "driver")
```

### Storage
```javascript
localStorage:
  - digiy_driver_access_pin    // Session PIN
  - digiy_driver_city          // Ville de travail

sessionStorage:
  - digiy_driver_ok            // Flag autorisation
  - digiy_driver_phone         // TÃ©lÃ©phone actuel
```

---

## ğŸ—ï¸ ARCHITECTURE TECHNIQUE

### Frontend
- **HTML5** pur (pas de framework lourd)
- **CSS3** moderne (variables CSS)
- **JavaScript** vanilla (fonction isolÃ©es)
- **Progressive Web App** ready

### Backend
- **Supabase** (PostgreSQL + Realtime)
- **Edge Functions** pour les RPC
- **Row Level Security** activÃ©

### Client Supabase IsolÃ©
```javascript
// âœ… Namespace global DIGIYLYFE
window._DIGIY_CLIENTS = window._DIGIY_CLIENTS || {};

// âœ… Client DRIVER isolÃ© (pas de conflit avec RESTO, LOC, etc.)
if(!window._DIGIY_CLIENTS.driver){
  window._DIGIY_CLIENTS.driver = window.supabase.createClient(
    SUPABASE_URL,
    SUPABASE_ANON_KEY
  );
}

const sb = window._DIGIY_CLIENTS.driver;
```

**Pourquoi ?**
- Isolation totale du module DRIVER
- Compatible avec autres modules DIGIYLYFE (RESTO, LOC, MARKET)
- Pas de conflit entre modules
- Scalable Ã  l'infini

---

## ğŸ—„ï¸ BASE DE DONNÃ‰ES

### Tables principales

#### `driver_profiles`
```sql
- id (uuid)
- phone (text, unique)
- full_name (text)
- whatsapp (text)
- sector_city (text)
- zones (text)
- vehicle (text)
- services (text[])
- start_time (time)
- end_time (time)
- rest_days (text[])
- note (text)
- created_at (timestamp)
- updated_at (timestamp)
```

#### `ride_requests`
```sql
- id (uuid)
- city (text)
- status (text)         # new, accepted, done, rejected, cancelled
- pickup_address (text)
- dropoff_address (text)
- client_phone (text)
- price (numeric)
- assigned_driver_phone (text)  # ClÃ© pour attribution
- accepted_at (timestamp)
- done_at (timestamp)
- created_at (timestamp)
```

#### `access_pins`
```sql
- phone (text, primary key)
- pin_hash (text)       # Hash bcrypt du PIN
- module (text)         # "driver", "resto", "loc", etc.
- active (boolean)
- created_at (timestamp)
- last_login (timestamp)
```

---

## ğŸ”„ FLUX UTILISATEUR

### 1ï¸âƒ£ Connexion
```
authentification-chauffeur.html
â†“ Entre tÃ©lÃ©phone + PIN
â†“ RPC verify_access_pin()
â†“ Si OK â†’ localStorage.setItem()
â†“ Redirect â†’ index.html
```

### 2ï¸âƒ£ Dashboard
```
index.html
â†“ VÃ©rifie session (verify_access_pin)
â†“ Si valide â†’ Affiche menu
â”œâ”€ Profil
â”œâ”€ Courses
â”œâ”€ Gains
â””â”€ DÃ©connexion
```

### 3ï¸âƒ£ Pool de courses
```
courses.html
â†“ Charge courses disponibles (assigned_driver_phone IS NULL)
â†“ Charge mes courses (assigned_driver_phone = mon phone)
â†“ Realtime ON â†’ Subscribe aux changements
â†“ Actions:
  â”œâ”€ Accept (claim course)
  â”œâ”€ Reject (si acceptÃ©e par erreur)
  â””â”€ Done (terminer course)
```

---

## ğŸ¨ DESIGN SYSTEM

### Couleurs
```css
:root {
  --bg: #F8FAF6;           /* Fond clair */
  --card: #fff;            /* Cartes */
  --line: #E5E7EB;         /* Bordures */
  --text: #111827;         /* Texte principal */
  --muted: #6B7280;        /* Texte secondaire */
  --gold: #EAB308;         /* Accent DIGIYLYFE */
  --green: #16A34A;        /* SuccÃ¨s */
  --danger: #EF4444;       /* Danger */
}
```

### Typographie
- **Font** : system-ui (natif OS)
- **Poids** : 650-950 (medium Ã  black)
- **Taille** : 13px-18px

### Composants
- **Boutons** : border-radius 16px, gradient gold
- **Cartes** : border-radius 20px, shadow subtile
- **Pills** : border-radius 999px, inline-flex
- **Messages** : Couleurs sÃ©mantiques (ok/bad)

---

## ğŸ”§ FONCTIONNALITÃ‰S

### âœ… ImplÃ©mentÃ©

#### Authentification
- [x] Connexion PIN
- [x] VÃ©rification session auto
- [x] DÃ©connexion propre
- [x] Effacer session

#### Profil
- [x] Fiche complÃ¨te chauffeur
- [x] Ã‰dition infos
- [x] Services multi-choix
- [x] Horaires travail
- [x] Jours de repos
- [x] Statut complÃ©tude

#### Courses
- [x] Pool courses (nouvelles)
- [x] Mes courses (assignÃ©es)
- [x] Filtre par ville
- [x] Realtime ON/OFF
- [x] Accept course (claim)
- [x] Reject course
- [x] Done course
- [x] Copier ID

#### Gains (si prÃ©sent)
- [x] Total encaissÃ©
- [x] Nombre de courses
- [x] Moyenne par course
- [x] Filtre pÃ©riode
- [x] DÃ©tails courses terminÃ©es

---

### ğŸ”œ Ã€ venir (Roadmap)

#### Phase 2
- [ ] Notifications push (PWA)
- [ ] Mode offline
- [ ] GÃ©olocalisation temps rÃ©el
- [ ] Chat client-chauffeur
- [ ] Photos vÃ©hicule
- [ ] Documents (permis, assurance)

#### Phase 3
- [ ] SystÃ¨me de notation
- [ ] Badges & rÃ©compenses
- [ ] Programme fidÃ©litÃ©
- [ ] Parrainage chauffeurs
- [ ] Formation en ligne

---

## ğŸ’° MODÃˆLE Ã‰CONOMIQUE

### Pour le chauffeur

#### Avec Uber (25% commission)
```
Course : 10,000 F
- Commission Uber : -2,500 F
- Frais : -2,000 F
= Net : 5,500 F

20 courses/semaine = 110,000 F/semaine
Ã— 4 semaines = 440,000 F/mois
```

#### Avec DIGIY DRIVER (abonnement)
```
Course : 10,000 F
- Abonnement : -500 F/jour (15,000 F/mois Ã· 30)
- Frais : -2,000 F
= Net : 7,500 F

20 courses/semaine = 150,000 F/semaine
Ã— 4 semaines = 600,000 F/mois

GAIN : +160,000 F/mois (+36%)
```

### Tarifs
- **Abonnement mensuel** : 15,000 F CFA (~25 USD)
- **Commission** : 0%
- **Frais cachÃ©s** : 0
- **Paiement direct** : Client â†’ Chauffeur (cash, Wave, Orange Money)

---

## ğŸš€ INSTALLATION & DÃ‰PLOIEMENT

### PrÃ©requis
- Compte Supabase
- Git
- Serveur web (GitHub Pages, Netlify, Vercel, ou custom)

### Setup Backend (Supabase)

1. **CrÃ©er projet Supabase**
   ```
   https://supabase.com/dashboard
   ```

2. **CrÃ©er tables**
   ```sql
   -- Voir section "Base de donnÃ©es" ci-dessus
   ```

3. **CrÃ©er RPC fonctions**
   ```sql
   -- verify_access_pin
   -- get_driver_profile_by_pin
   -- save_driver_profile_by_pin
   ```

4. **Activer Realtime**
   ```sql
   ALTER PUBLICATION supabase_realtime ADD TABLE ride_requests;
   ```

5. **Configurer RLS (Row Level Security)**
   ```sql
   -- Policies par module
   ```

### Setup Frontend

1. **Cloner le repo**
   ```bash
   git clone https://github.com/beauville/digiy-pro-driver.git
   cd digiy-pro-driver
   ```

2. **Configurer Supabase**
   ```javascript
   // Dans chaque fichier HTML
   const SUPABASE_URL = "https://votre-projet.supabase.co";
   const SUPABASE_ANON_KEY = "votre-clÃ©-anon";
   ```

3. **DÃ©ployer**
   ```bash
   git add .
   git commit -m "Initial commit"
   git push origin main
   ```

### GitHub Pages
```bash
Settings â†’ Pages â†’ Source: main branch
```

---

## ğŸ§ª TESTS

### Test local
```bash
# Serveur local simple
python3 -m http.server 8000
# Puis ouvre http://localhost:8000
```

### Test mobile
```bash
# Expose ton serveur local
ngrok http 8000
# Ou utilise GitHub Pages directement
```

### Checklist de test
- [ ] Connexion PIN fonctionne
- [ ] Session persiste aprÃ¨s reload
- [ ] Profil se charge
- [ ] Profil se sauvegarde
- [ ] Pool courses s'affiche
- [ ] Realtime fonctionne
- [ ] Accept course claim correctement
- [ ] Done course met Ã  jour le statut
- [ ] DÃ©connexion efface la session
- [ ] Pas d'erreur console (F12)

---

## ğŸ”’ SÃ‰CURITÃ‰

### Bonnes pratiques
- âœ… Pas de clÃ© privÃ©e Supabase en frontend
- âœ… RPC avec validation cÃ´tÃ© serveur
- âœ… Row Level Security activÃ©
- âœ… PIN hashÃ© en bcrypt
- âœ… RequÃªtes filtrÃ©es par `assigned_driver_phone`
- âœ… Validation des inputs

### Ce que le frontend NE PEUT PAS faire
- âŒ Modifier les courses d'un autre chauffeur
- âŒ Voir les donnÃ©es d'un autre chauffeur
- âŒ Accepter une course dÃ©jÃ  assignÃ©e
- âŒ Terminer une course qui n'est pas la sienne

---

## ğŸ› DEBUGGING

### Console navigateur (F12)
```javascript
// VÃ©rifier session
localStorage.getItem("digiy_driver_access_pin")

// VÃ©rifier client Supabase
window._DIGIY_CLIENTS.driver

// Nettoyer session
localStorage.clear()
sessionStorage.clear()
delete window._DIGIY_CLIENTS
location.reload()
```

### Erreurs communes

**"Identifier already declared"**
â†’ Ancien fichier en cache. Vide le cache (CTRL + SHIFT + DELETE)

**"Session invalide"**
â†’ PIN expirÃ© ou incorrect. Reconnecte-toi.

**"RPC Error"**
â†’ VÃ©rifie que les fonctions RPC existent dans Supabase

**Boucle infinie**
â†’ Vide le cache et ferme tous les onglets

---

## ğŸ“± COMPATIBILITÃ‰

### Navigateurs supportÃ©s
- âœ… Chrome 90+
- âœ… Safari 14+
- âœ… Firefox 88+
- âœ… Edge 90+

### Mobiles
- âœ… iOS 14+
- âœ… Android 8+

### PWA (Progressive Web App)
- [x] Manifest.json
- [x] Service Worker (Ã  venir)
- [x] Installable
- [x] Mode offline (Ã  venir)

---

## ğŸ¤ CONTRIBUTION

### RÃ¨gles
1. **Code propre** : Vanilla JS, pas de framework lourd
2. **Commentaires** : Explique ton code
3. **Tests** : Teste avant de commit
4. **Respect** : Pas de vol de commission !

### Pattern de code
```javascript
// âœ… TOUJOURS utiliser le namespace
window._DIGIY_CLIENTS = window._DIGIY_CLIENTS || {};

// âœ… TOUJOURS isoler dans une fonction
(function(){
  'use strict';
  // Ton code ici
})();

// âœ… TOUJOURS vÃ©rifier la session
async function guardPin(){ ... }
```

---

## ğŸ“ SUPPORT

### Documentation
- **Supabase** : https://supabase.com/docs
- **JavaScript** : https://developer.mozilla.org

### Contact
- **Email** : support@digiylyfe.com
- **WhatsApp** : +221 XX XXX XX XX
- **Site** : https://digiylyfe.com

---

## ğŸ“„ LICENCE

**PropriÃ©tÃ© de DIGIYLYFE**

Ce code est la propriÃ©tÃ© intellectuelle de DIGIYLYFE.  
Utilisation commerciale interdite sans autorisation.

---

## ğŸŒ MISSION

> **"L'Afrique enracinÃ©e, connectÃ©e au monde"**

DIGIY PRO DRIVER fait partie de l'Ã©cosystÃ¨me DIGIYLYFE :
- ğŸš— **DRIVER** : Transport sans commission
- ğŸ´ **RESTO** : POS pour restaurants
- ğŸ  **LOC** : HÃ©bergements directs
- ğŸ›’ **MARKET** : Marketplace 0%
- ğŸ“¦ **FRET** : Transport de marchandises
- ğŸ’¼ **JOBS** : Emploi local
- ğŸ’³ **PAY** : Paiements directs

**L'argent au peuple. La dignitÃ© au travailleur.**

---

## ğŸ“Š STATISTIQUES

- **Chauffeurs actifs** : [Ã€ venir]
- **Courses complÃ©tÃ©es** : [Ã€ venir]
- **Argent gardÃ© par les chauffeurs** : [Ã€ venir]
- **Commission volÃ©e Ã©vitÃ©e** : [Ã€ venir]

---

## ğŸ¯ VISION 2025

- 10,000 chauffeurs actifs
- 1,000,000 courses/an
- 5 milliards F CFA gardÃ©s par les chauffeurs
- Extension Ã  toute l'Afrique de l'Ouest

---

**ConÃ§u avec â¤ï¸ pour l'Afrique**  
**Par des africains, pour des africains**  
**0% commission. 100% dignitÃ©.**

**âˆ DIGIYLYFE â€” Pierre par pierre, on construit**

---

*DerniÃ¨re mise Ã  jour : DÃ©cembre 2024*
